##Дополнения к классу редактора отчётов.

<b><i>Небольшое отступление.</b><br>
<p align="justify">С каждым внедряемым в эксплуатацию модулем системы был сопряжён рост информационных отчётов - различных сводок, справок, накладных, сертификатов и других печатных форм.
Опыт сопровождения подобного рода документов позволил сформулировать ряд общих требований, к одному из таких относилась необходимость в разработке некоего функционала, позволяющего вносить "горячие" изменения в печатные данные отчётов (отчётов, которые хранят своё состояние, а не используют оперативные данные).</p>
Данный функционал должен был обладать:<br>
<ul>
 <li>универсальностью (не зависеть от содержимого и внешнего вида печатных документов);</li>
 <li>требовать минимального изменения контролов, в которых будет использоваться.</li>
</ul>
<p align="justify">
В результате, разработчиками компании был написан общий класс отчётов "PlantStoredReports" взаимодействующий с диалоговым <a href="https://raw.githubusercontent.com/M-Panteleev/Portfolio-2015/master/PlantStoredReports/Screenshots/AnodeReportDay.png" target="_blank" title= "Открыть в новой вкдадке">окном</a> редактирования "ReportDataDialog" и дополнительные классы данных в "DataReportClasses" содержащие свойства интерфейсной части редактора.<br>
</p>

![image1](https://raw.githubusercontent.com/M-Panteleev/Portfolio-2015/master/PlantStoredReports/Screenshots/AnodeReportDay.png "Внешний вид редактора отчётов")
<p align="center">Рисунок 1. Внешний вид редактора отчётов.</p>

<p align="justify">
Моей задачей было расширение функциональных возможностей данного редактора. Процесс внесения изменений был завязан на архитектурных особенностях данного решения. Совместимость обновлённого редактора с прежними отчётами осталась неизменной.</p></i>

<b>Результат работы:</b><br><br>
<p align="justify">1.  Добавлены дополнительные свойства полей и наборов данных в классы интерфейсной части редактора ("<a href="https://github.com/M-Panteleev/Portfolio-2015/blob/master/PlantStoredReports/CS/DataReportClasses.cs" target="_blank" title= "Открыть в новой вкдадке">DataReportClasses.cs</a>") и в сам контрол отчёта ("<a href="https://github.com/M-Panteleev/Portfolio-2015/blob/master/PlantStoredReports/CS/AnodeReportDay.cs" target="_blank" title= "Открыть в новой вкдадке">AnodeReportDay.cs</a>").<br>
2.  Расширен набор передаваемых параметров в диалоговое окно ("<a  href="https://github.com/M-Panteleev/Portfolio-2015/blob/master/PlantStoredReports/CS/ReportDataDialog.cs" target="_blank" title= "Открыть в новой вкдадке">ReportDataDialog.cs</a>") из общего класса отчётов. Добавлены дополнительные флаги и свойства в общий класс ("<a href="https://github.com/M-Panteleev/Portfolio-2015/blob/master/PlantStoredReports/CS/PlantStoredReports.cs" target="_blank" title= "Открыть в новой вкдадке">PlantStoredReports.cs</a>").<br>
3.  В грид диалогового окна редактора добавлена возможность подключения автоизменяемых полей, отображающих дату редактирования и ФИО пользователя внёсшего изменения. Дата и ФИО заполняются автоматически при внесении изменений в грид редактора. Добавление автоизменяемых полей в грид настраивается значением входного статуса. Управление полями необходимо ввиду отсутствия данных значений в рекордсете большинства «старых» отчётов. Настройка по входному флагу даёт возможность использовать и старые хранимые процедуры (ХП) и модернизированные - где ФИО и дата уже передаются.<br>
4.  Добавлена обработка ввода данных (с клавиатуры и вставка из буфера обмена).<br>
5.  Добавлен контроль разрядности вещественных чисел (обработка ошибки переполнения, возникающей при попытке записи десятичного числа превышающего принятую в БД разрядность - decimal(9,3)).<br>
6.  Найдены и устранены причины сброса визуальных настроек полей грида задаваемых вручную (ширина, цвет фона, выравнивание и т.п.).<br>
7.  Добавлено групповое изменение идентичных значений для записей состоящих в одной группе.<br>
Автоматическое изменение значений выполнятся в том же столбце, в котором было выполнено редактирование первой измененяемой ячейки. Часто возникает ситуация, когда ХП отчёта возвращает рекордсет, у записей которого содержимое одного из редактируемых полей совпадает (например, записи различаются по содержимому большинства полей, но имеют одинаковое итоговое значение), и при редактировании данных такого отчёта пользователю не ясно для какой записи выполнить изменение итога, чтобы после сохранения изменённое значение отобразилось в отчёте. Автоматическое изменения всех записей с одним и тем же итогом, позволяет исключить неоднозначность, пользователю больше не требуется последовательно (как это было раньше) изменять строку за строкой и потом смотреть отобразилось отредактированное значение в отчёте после сохранения или нет.<br>
8. Добавлена возможность раскраски столбцов со статусом "только для чтения", например: рекордсет отчёта передаёт в редактор два поля с одним и тем же параметром – одно содержит расчётное значение (оригинальное), а другое откорректированное пользователем (доступное для изменения). Оригинальное заблокировано для редактирования и окрашивается в неактивный серый цвет.</p>

<p align="justify">Добавление двух видов полей, содержащих оригинальные значения и откорректированные пользователем, а также добавление полей, содержащих дату последнего редактирования и ФИО пользователя внёсшего изменения, являлись ключевыми требованиями данной работы.</p><br>
<b>Расширение функционала позволило:</b><br>
* руководителям отделов контролировать внесение изменений подчинёнными;<br>
* администраторам системы возможность отследить действия пользователей без использования SSMS.<br>
